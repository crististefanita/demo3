<!DOCTYPE html>

<html lang="ro">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>Living Architecture (UI + API) — Canonical v1.0</title>
<style>
  :root {
   --bg: #0b0f14;
   --panel: #111826;
   --panel2: #0f1724;
   --text: #e6edf3;
   --muted: #a8b3cf;
   --border: #243044;
   --accent: #7aa2ff;
   --accent2: #6ee7b7;
   --warn: #fbbf24;
   --bad: #fb7185;
   --good: #34d399;
   --codebg: #0a0f18;
   --shadow: rgba(0,0,0,.35);
   --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
   --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif;
  }
  html, body { height: 100%; }
  body {
   margin: 0;
   font-family: var(--sans);
   background: radial-gradient(1200px 800px at 10% 0%, #142038 0%, var(--bg) 45%) fixed;
   color: var(--text);
   line-height: 1.55;
  }
  a { color: var(--accent); text-decoration: none; }
  a:hover { text-decoration: underline; }
  .wrap { max-width: 1150px; margin: 0 auto; padding: 28px 18px 60px; }
  header {
   background: linear-gradient(180deg, rgba(17,24,38,.85), rgba(17,24,38,.35));
   border: 1px solid var(--border);
   box-shadow: 0 12px 30px var(--shadow);
   border-radius: 18px;
   padding: 22px 22px 18px;
   margin-bottom: 16px;
  }
  h1 { margin: 0 0 6px; font-size: 26px; letter-spacing: .2px; }
  .sub { color: var(--muted); font-size: 14px; }
  .badge {
   display: inline-block; padding: 3px 10px; border-radius: 999px;
   border: 1px solid var(--border); background: rgba(15,23,36,.75);
   font-size: 12px; color: var(--muted); margin-left: 8px;
  }
  .grid {
   display: grid;
   grid-template-columns: 1.2fr .8fr;
   gap: 14px;
   margin-top: 14px;
  }
  @media (max-width: 980px) {
   .grid { grid-template-columns: 1fr; }
  }
  .card {
   border: 1px solid var(--border);
   border-radius: 16px;
   background: rgba(17,24,38,.72);
   box-shadow: 0 10px 26px var(--shadow);
   padding: 16px 16px 14px;
  }
  .card h2 { margin: 0 0 10px; font-size: 18px; }
  .kvs { display: grid; grid-template-columns: 180px 1fr; gap: 8px 12px; }
  .k { color: var(--muted); }
  code.inline {
   font-family: var(--mono); font-size: 12.5px;
   background: rgba(10,15,24,.75);
   border: 1px solid var(--border);
   padding: 2px 6px; border-radius: 8px;
  }
  pre {
   background: rgba(10,15,24,.88);
   border: 1px solid var(--border);
   border-radius: 14px;
   padding: 12px 12px;
   overflow: auto;
   box-shadow: inset 0 0 0 1px rgba(255,255,255,.02);
   margin: 10px 0 0;
  }
  pre code {
   font-family: var(--mono);
   font-size: 12.5px;
   color: #dbe7ff;
   white-space: pre;
  }
  .note {
   border-left: 3px solid var(--accent2);
   padding: 10px 12px;
   background: rgba(16, 185, 129, .08);
   border-radius: 12px;
   color: var(--text);
  }
  .warn {
   border-left: 3px solid var(--warn);
   padding: 10px 12px;
   background: rgba(251, 191, 36, .08);
   border-radius: 12px;
  }
  .rule {
   border-left: 3px solid var(--accent);
   padding: 10px 12px;
   background: rgba(122, 162, 255, .08);
   border-radius: 12px;
   margin: 10px 0;
  }
  .pill {
   display:inline-block; font-size: 12px; padding: 2px 8px;
   border-radius: 999px; border: 1px solid var(--border);
   background: rgba(15,23,36,.7); color: var(--muted);
   margin-right: 6px;
  }
  details {
   border: 1px solid var(--border);
   background: rgba(15,23,36,.55);
   border-radius: 16px;
   padding: 10px 12px;
   margin: 12px 0;
   box-shadow: 0 8px 22px var(--shadow);
  }
  summary {
   cursor: pointer;
   list-style: none;
   font-weight: 600;
   color: var(--text);
   display: flex;
   align-items: center;
   justify-content: space-between;
   gap: 10px;
   padding: 4px 2px;
  }
  summary::-webkit-details-marker { display:none; }
  .sumhint { color: var(--muted); font-weight: 400; font-size: 12px; }
  .split {
   display:grid; grid-template-columns: 1fr 1fr; gap: 12px;
  }
  @media (max-width: 980px) {
   .split { grid-template-columns: 1fr; }
  }
  .mini h3 { margin: 8px 0 8px; font-size: 15px; }
  ul { margin: 8px 0 0 18px; }
  li { margin: 4px 0; }
  hr.sep { border: 0; border-top: 1px solid var(--border); margin: 16px 0; }
  .muted { color: var(--muted); }

  /* Diagram framing (match preview) */
  .diag {
   background: #020617;
   border: 1px solid #334;
   border-radius: 12px;
   padding: 12px;
   overflow: auto;
   margin-top: 10px;
  }
  .diag svg { display: block; background: #020617; border-radius: 10px; }
  .diag details { margin-top: 10px; box-shadow: none; }
  .diag details summary { color: #93c5fd; font-weight: 600; }
 </style>
</head>
<body>
<div class="wrap">
<header>
<h1>Living Architecture (UI + API) — Canonical <span class="badge">v1.0</span></h1>
<div class="sub">Document canonic pentru arhitectura UI + API (versiune v1_1).</div>
</header>
<div class="grid">
<div class="card">
<h2>1) Abordare</h2>
<div class="kvs">
<div class="k">Root packages</div>
<div><code class="inline">com.endava.ai.ui</code> + <code class="inline">com.endava.ai.api</code></div>
<div class="k">Config unificată</div>
<div>Totul în <code class="inline">framework.properties</code> (classpath: <code class="inline">src/main/resources</code>)</div>
<div class="k">Model de interacțiune</div>
<div><span class="pill">UI</span> UIActions + WaitUtils + UIEngine (Selenium/Playwright)</div>
<div class="k">Model de apel</div>
<div><span class="pill">API</span> ApiClient + Service Objects + Validations (TestNG orchestration only)</div>
<div class="k">Reporting unificat</div>
<div><code class="inline">ReportLogger</code> + <code class="inline">ReportingManager</code> + <code class="inline">StepLogger</code></div>
<div class="k">Engines</div>
<div><span class="pill">reporting.engine</span> extent | allure <span class="muted">(+ viitoare adapters)</span></div>
<div class="k">Reutilizare reporting (API)</div>
<div><span class="pill">reporting.mode</span> shared | local <span class="muted">(shared → reuse com.endava.ai.reporting)</span></div>
</div>
<hr class="sep"/>
<h3>Parametri canonici de arhitectură</h3>
<ul>
<li><b>UI root package</b>: <code class="inline">com.endava.ai.ui</code></li>
<li><b>API root package</b>: <code class="inline">com.endava.ai.api</code></li>
<li><b>Reporting module</b>: <code class="inline">com.endava.ai.reporting</code></li>
</ul>
<div class="rule">
<b>Principiu:</b> Testele orchestrează fluxuri; apelurile directe API sau UI nu apar în teste.
   </div>
<div class="split">
<div class="mini">
<h3>UI — responsabilități pe layere</h3>
<ul>
<li><b>Tests</b> → doar orchestrare</li>
<li><b>Pages</b> → doar locatori</li>
<li><b>Services</b> → doar fluxuri (workflows)</li>
<li><b>Validations</b> → doar aserțiuni</li>
</ul>
</div>
<div class="mini">
<h3>API — responsabilități pe layere</h3>
<ul>
<li><b>Tests</b> → doar orchestrare</li>
<li><b>Services</b> → doar fluxuri</li>
<li><b>Validation</b> → doar aserțiuni</li>
</ul>
</div>
</div>
</div>
<div class="card">
<h2>Config cheie</h2>
<div class="note">
    Obiectiv: 0 hardcoding. Totul vine din config și e accesat doar prin <b>ConfigManager</b>.
   </div>
<details open="">
<summary>UI — proprietăți <span class="sumhint">framework.properties</span></summary>
<pre><code>base.url=https://practicesoftwaretesting.com
ui.engine=default      # default -&gt; selenium
reports.dir=reports
reporting.engine=extent   # extent | allure
explicit.wait.seconds=2
reports.timestamp.enabled=true
reports.timestamp.format=yyyy-MM-dd_HH-mm-ss
console.details.enabled=true
allure.results.dir=allure-results  # obligatoriu dacă reporting.engine=allure</code></pre>
</details>
<details>
<summary>API — proprietăți <span class="sumhint">framework.properties</span></summary>
<pre><code>base.url.api=https://gorest.co.in
reports.dir=reports
reporting.mode=shared    # shared | local
reporting.engine=extent   # compatibil cu modulul de reporting reutilizat
reports.timestamp.enabled=true
reports.timestamp.format=yyyy-MM-dd_HH-mm-ss
console.details.enabled=true # dacă modulul de reporting o suportă</code></pre>
<div class="rule">
<b>Clarificare (reporting.mode):</b> <code class="inline">shared</code> reutilizează <b>modelul de reporting</b> + <b>adapterul</b> (ReportLogger/ReportingManager/adapters),
nu lifecycle-ul. Lifecycle-ul rămâne <b>unic</b> per execuție și este controlat de <code class="inline">TestListener</code>.
<br/><br/>
<b>Notă:</b> pentru claritate, <code class="inline">TestListener</code> poate fi mutat în <code class="inline">com.endava.ai.core.reporting</code> (aceeași implementare, același contract),
astfel încât să fie evident că este comun UI+API.
</div>
</details>
<div class="warn">
<b>Regulă:</b> <code class="inline">reports.dir</code> și <code class="inline">allure.results.dir</code> (când e cazul) trebuie create înainte de primul raport.
   </div>
</div>
</div>
<hr class="sep"/>
<div class="card">
<h2>2) Diagrame de arhitectură</h2>
<details open=""><summary>2.1 Structura modulelor și fluxurile principale (UI + API)</summary><details><summary>2.1.1 Structura modulelor (static) <span class="sumhint">component</span></summary><div class="card">
<div class="diag">
<svg aria-label="Structura modulelor (static)" height="380" viewbox="0 0 980 380" width="980">
<!-- frames -->
<rect fill="#0b1220" height="320" rx="14" stroke="#334" width="300" x="20" y="30"></rect>
<text fill="#9ddcff" font-size="14" x="38" y="58">UI Module</text>
<rect fill="#0b1220" height="320" rx="14" stroke="#334" width="300" x="340" y="30"></rect>
<text fill="#9ddcff" font-size="14" x="358" y="58">API Module</text>
<rect fill="#0b1220" height="320" rx="14" stroke="#334" width="300" x="660" y="30"></rect>
<text fill="#9ddcff" font-size="14" x="678" y="58">Reporting</text>
<!-- nodes (preview v0.9 style) -->
<!-- UI column -->
<rect fill="#1e293b" height="60" rx="8" width="240" x="50" y="90"></rect>
<text fill="#e6e9ef" text-anchor="middle" x="170" y="126">Tests</text>
<rect fill="#1e293b" height="60" rx="8" width="240" x="50" y="168"></rect>
<text fill="#e6e9ef" text-anchor="middle" x="170" y="204">Services</text>
<rect fill="#1e293b" height="60" rx="8" width="240" x="50" y="246"></rect>
<text fill="#e6e9ef" text-anchor="middle" x="170" y="282">UIActions</text>
<!-- UI arrows -->
<line stroke="#93c5fd" stroke-width="2" x1="170" x2="170" y1="150" y2="168"></line>
<polyline fill="none" points="166,162 170,168 174,162" stroke="#93c5fd" stroke-width="2"></polyline>
<line stroke="#93c5fd" stroke-width="2" x1="170" x2="170" y1="228" y2="246"></line>
<polyline fill="none" points="166,240 170,246 174,240" stroke="#93c5fd" stroke-width="2"></polyline>
<!-- API column -->
<rect fill="#1e293b" height="60" rx="8" width="240" x="370" y="90"></rect>
<text fill="#e6e9ef" text-anchor="middle" x="490" y="126">Tests</text>
<rect fill="#1e293b" height="60" rx="8" width="240" x="370" y="168"></rect>
<text fill="#e6e9ef" text-anchor="middle" x="490" y="204">Services</text>
<rect fill="#1e293b" height="60" rx="8" width="240" x="370" y="246"></rect>
<text fill="#e6e9ef" text-anchor="middle" x="490" y="282">Validation</text>
<line stroke="#93c5fd" stroke-width="2" x1="490" x2="490" y1="150" y2="168"></line>
<polyline fill="none" points="486,162 490,168 494,162" stroke="#93c5fd" stroke-width="2"></polyline>
<line stroke="#93c5fd" stroke-width="2" x1="490" x2="490" y1="228" y2="246"></line>
<polyline fill="none" points="486,240 490,246 494,240" stroke="#93c5fd" stroke-width="2"></polyline>
<!-- Reporting column -->
<rect fill="#1e293b" height="60" rx="8" width="240" x="690" y="90"></rect>
<text fill="#e6e9ef" text-anchor="middle" x="810" y="126">TestListener</text>
<rect fill="#1e293b" height="60" rx="8" width="240" x="690" y="168"></rect>
<text fill="#e6e9ef" text-anchor="middle" x="810" y="204">StepLogger</text>
<rect fill="#1e293b" height="60" rx="8" width="240" x="690" y="246"></rect>
<text fill="#e6e9ef" text-anchor="middle" x="810" y="282">ReportingMgr → ReportLogger → Adapters</text>
<!-- Reporting arrows -->
<line stroke="#93c5fd" stroke-width="2" x1="810" x2="810" y1="150" y2="168"></line>
<polyline fill="none" points="806,162 810,168 814,162" stroke="#93c5fd" stroke-width="2"></polyline>
<line stroke="#93c5fd" stroke-width="2" x1="810" x2="810" y1="228" y2="246"></line>
<polyline fill="none" points="806,240 810,246 814,240" stroke="#93c5fd" stroke-width="2"></polyline>
</svg>
<details>
<summary>Explicație <span class="sumhint">structură și responsabilități</span></summary>
<ul>
<li><b>Ce arată:</b> Separarea strictă a responsabilităților între modulele UI, API și Reporting.</li>
<li><b>UI Module:</b> Testele orchestrează doar fluxuri. Logica UI este împărțită în Services (workflow),
        Pages (locatori), UIActions (interacțiuni) și WaitUtils (așteptări).</li>
<li><b>API Module:</b> Testele orchestrează. Service Objects execută apeluri HTTP,
        Validation conține exclusiv aserțiuni.</li>
<li><b>Reporting:</b> Centralizează lifecycle-ul testelor și pașilor.
        TestListener inițiază testele, StepLogger gestionează pașii, ReportingManager selectează engine-ul.</li>
<li><b>De ce e important:</b> Această structură separă testele de motoarele UI/API și de reporting, permițând schimbarea lor fără a afecta testele.</li>
</ul>
</details>
</div>
</div></details><details><summary>2.1.2 Flux UI → Reporting <span class="sumhint">sequence</span></summary><div class="card">
<p class="muted">Fluxul arată cum acțiunile UI devin pași în raport și cum sunt rutate către engine-ul de reporting prin abstractions.</p>
<div class="diag">
<svg aria-label="Flux UI → Reporting" height="250" viewbox="0 0 980 250" width="980">
<defs>
<marker id="arrow" markerheight="10" markerunits="strokeWidth" markerwidth="10" orient="auto" refx="9" refy="3">
<path d="M0,0 L10,3 L0,6 z" fill="#93c5fd"></path>
</marker>
</defs>
<!-- -->
<text fill="#a8b3cf" font-size="12" x="40" y="44"></text>
<rect fill="#1e293b" height="44" rx="10" width="150" x="40" y="60"></rect>
<text fill="#e6e9ef" font-size="13" text-anchor="middle" x="115" y="88">Tests</text>
<rect fill="#1e293b" height="44" rx="10" width="170" x="220" y="60"></rect>
<text fill="#e6e9ef" font-size="13" text-anchor="middle" x="305" y="88">Services</text>
<rect fill="#1e293b" height="44" rx="10" width="170" x="420" y="60"></rect>
<text fill="#e6e9ef" font-size="13" text-anchor="middle" x="505" y="88">UIActions</text>
<!-- lane -->
<text fill="#a8b3cf" font-size="12" x="40" y="142"></text>
<rect fill="#1e293b" height="44" rx="10" width="170" x="420" y="158"></rect>
<text fill="#e6e9ef" font-size="13" text-anchor="middle" x="505" y="186">StepLogger</text>
<rect fill="#1e293b" height="44" rx="10" width="170" x="610" y="158"></rect>
<text fill="#e6e9ef" font-size="13" text-anchor="middle" x="695" y="186">ReportingMgr</text>
<rect fill="#1e293b" height="44" rx="10" width="160" x="800" y="158"></rect>
<text fill="#e6e9ef" font-size="13" text-anchor="middle" x="880" y="186">ReportLogger</text>
<rect fill="#1e293b" height="34" rx="10" width="160" x="800" y="210"></rect>
<text fill="#e6e9ef" font-size="12" text-anchor="middle" x="880" y="232">Extent | Allure</text>
<!-- Arrows (no crossings) -->
<line marker-end="url(#arrow)" stroke="#93c5fd" stroke-width="2" x1="190" x2="220" y1="82" y2="82"></line>
<line marker-end="url(#arrow)" stroke="#93c5fd" stroke-width="2" x1="390" x2="420" y1="82" y2="82"></line>
<!-- Drop to StepLogger -->
<path d="M505 104 C505 122, 505 130, 505 158" fill="none" marker-end="url(#arrow)" stroke="#6ee7b7" stroke-width="2"></path>
<text fill="#a7f3d0" font-size="11" x="520" y="132">step semantics</text>
<line marker-end="url(#arrow)" stroke="#93c5fd" stroke-width="2" x1="590" x2="610" y1="180" y2="180"></line>
<line marker-end="url(#arrow)" stroke="#93c5fd" stroke-width="2" x1="780" x2="800" y1="180" y2="180"></line>
<path d="M880 202 C880 206, 880 206, 880 210" fill="none" marker-end="url(#arrow)" stroke="#93c5fd" stroke-width="2"></path>
</svg>
<details>
<summary>Explicație <span class="sumhint">transformarea acțiunilor UI în pași raportați</span></summary>
<ul>
<li><b>Ce ilustrează:</b> Transformarea unei acțiuni UI într-un pas semantic raportat.</li>
<li><b>Tests:</b> Declanșează acțiuni de nivel înalt, independent de engine-ul UI folosit (Selenium, Playwright).</li>
<li><b>UIActions:</b> Decide dacă este necesar un wait și execută acțiunea prin engine.</li>
<li><b>StepLogger:</b> Creează pasul, loghează detalii și controlează PASS/FAIL.</li>
<li><b>ReportingManager:</b> Selectează adapterul de raportare (Extent / Allure).</li>
<li><b>Regulă cheie:</b> Fiecare pas poate avea un singur FAIL; engine-ul și testele nu fac logging direct.</li>
</ul>
</details>
</div>
</div></details><details><summary>2.1.3 Flux API → Reporting <span class="sumhint">sequence</span></summary><div class="card">
<p class="muted">Flux simetric: apelurile HTTP și validările devin pași în raport prin același contract (StepLogger → ReportingManager → ReportLogger).</p>
<div class="diag">
<svg aria-label="Flux API → Reporting" height="250" viewbox="0 0 980 250" width="980">
<defs>
<marker id="arrow2" markerheight="10" markerunits="strokeWidth" markerwidth="10" orient="auto" refx="9" refy="3">
<path d="M0,0 L10,3 L0,6 z" fill="#93c5fd"></path>
</marker>
</defs>
<!-- -->
<text fill="#a8b3cf" font-size="12" x="40" y="44"></text>
<rect fill="#1e293b" height="44" rx="10" width="150" x="40" y="60"></rect>
<text fill="#e6e9ef" font-size="13" text-anchor="middle" x="115" y="88">Tests</text>
<rect fill="#1e293b" height="44" rx="10" width="180" x="220" y="60"></rect>
<text fill="#e6e9ef" font-size="13" text-anchor="middle" x="310" y="88">Services</text>
<rect fill="#1e293b" height="44" rx="10" width="180" x="430" y="60"></rect>
<text fill="#e6e9ef" font-size="13" text-anchor="middle" x="520" y="88">Validation</text>
<!-- lane -->
<text fill="#a8b3cf" font-size="12" x="40" y="142"></text>
<rect fill="#1e293b" height="44" rx="10" width="180" x="430" y="158"></rect>
<text fill="#e6e9ef" font-size="13" text-anchor="middle" x="520" y="186">StepLogger</text>
<rect fill="#1e293b" height="44" rx="10" width="170" x="630" y="158"></rect>
<text fill="#e6e9ef" font-size="13" text-anchor="middle" x="715" y="186">ReportingMgr</text>
<rect fill="#1e293b" height="44" rx="10" width="140" x="820" y="158"></rect>
<text fill="#e6e9ef" font-size="13" text-anchor="middle" x="890" y="186">ReportLogger</text>
<rect fill="#1e293b" height="34" rx="10" width="140" x="820" y="210"></rect>
<text fill="#e6e9ef" font-size="12" text-anchor="middle" x="890" y="232">Extent | Allure</text>
<!-- Arrows (no crossings) -->
<line marker-end="url(#arrow2)" stroke="#93c5fd" stroke-width="2" x1="190" x2="220" y1="82" y2="82"></line>
<line marker-end="url(#arrow2)" stroke="#93c5fd" stroke-width="2" x1="400" x2="430" y1="82" y2="82"></line>
<!-- Drop to StepLogger -->
<path d="M520 104 C520 122, 520 130, 520 158" fill="none" marker-end="url(#arrow2)" stroke="#6ee7b7" stroke-width="2"></path>
<text fill="#a7f3d0" font-size="11" x="538" y="132">step semantics</text>
<line marker-end="url(#arrow2)" stroke="#93c5fd" stroke-width="2" x1="610" x2="630" y1="180" y2="180"></line>
<line marker-end="url(#arrow2)" stroke="#93c5fd" stroke-width="2" x1="800" x2="820" y1="180" y2="180"></line>
<path d="M890 202 C890 206, 890 206, 890 210" fill="none" marker-end="url(#arrow2)" stroke="#93c5fd" stroke-width="2"></path>
</svg>
<details>
<summary>Explicație <span class="sumhint">raportare unificată pentru API</span></summary>
<ul>
<li><b>Ce ilustrează:</b> Transformarea apelurilor HTTP și a validărilor în pași raportați.</li>
<li><b>Services:</b> Execută apelurile HTTP prin ApiClient.</li>
<li><b>Validation:</b> Rulează aserțiunile exclusiv în pași logați.</li>
<li><b>StepLogger:</b> Asigură o semantică de logging unitară.</li>
<li><b>Beneficiu:</b> Toate testele folosesc același model de raportare.</li>
</ul>
</details>
</div>
</div></details></details>
<details>
<summary>2.2 Flux TestNG + StepLogger (reguli de eșec) <span class="sumhint">sequence</span></summary>
<div class="diag">
<!-- SVG: sequence diagram (style aligned to preview) -->
<svg aria-label="TestNG + StepLogger flow" height="420" viewbox="0 0 980 420" width="980">
<defs>
<marker id="arrow2" markerheight="10" markerunits="strokeWidth" markerwidth="10" orient="auto" refx="9" refy="3">
<path d="M0,0 L10,3 L0,6 z" fill="#93c5fd"></path>
</marker>
<marker id="arrowFail" markerheight="10" markerunits="strokeWidth" markerwidth="10" orient="auto" refx="9" refy="3">
<path d="M0,0 L10,3 L0,6 z" fill="#f87171"></path>
</marker>
</defs>
<!-- lifeline labels -->
<text fill="#9ddcff" font-size="14" x="90" y="34">TestNG</text>
<text fill="#9ddcff" font-size="14" x="270" y="34">TestListener</text>
<text fill="#9ddcff" font-size="14" x="470" y="34">StepLogger</text>
<text fill="#9ddcff" font-size="14" x="650" y="34">ReportingManager</text>
<text fill="#9ddcff" font-size="14" x="840" y="34">ReportLogger</text>
<!-- lifelines -->
<line stroke="#334" x1="90" x2="90" y1="54" y2="390"></line>
<line stroke="#334" x1="270" x2="270" y1="54" y2="390"></line>
<line stroke="#334" x1="470" x2="470" y1="54" y2="390"></line>
<line stroke="#334" x1="650" x2="650" y1="54" y2="390"></line>
<line stroke="#334" x1="840" x2="840" y1="54" y2="390"></line>
<!-- messages -->
<line stroke="#93c5fd" stroke-width="2" x1="90" x2="270" y1="92" y2="92"></line><polygon fill="#93c5fd" points="270.00,92.00 260.00,98.00 260.00,86.00" stroke="#93c5fd" stroke-width="2"></polygon>
<text fill="#e6e9ef" font-size="12" text-anchor="middle" x="180" y="82">onTestStart()</text>
<line stroke="#93c5fd" stroke-width="2" x1="270" x2="650" y1="130" y2="130"></line><polygon fill="#93c5fd" points="650.00,130.00 640.00,136.00 640.00,124.00" stroke="#93c5fd" stroke-width="2"></polygon>
<text fill="#e6e9ef" font-size="12" text-anchor="middle" x="460" y="120">getLogger()</text>
<line stroke="#93c5fd" stroke-width="2" x1="650" x2="840" y1="160" y2="160"></line><polygon fill="#93c5fd" points="840.00,160.00 830.00,166.00 830.00,154.00" stroke="#93c5fd" stroke-width="2"></polygon>
<text fill="#e6e9ef" font-size="12" text-anchor="middle" x="745" y="150">resolve by reporting.engine</text>
<line stroke="#93c5fd" stroke-width="2" x1="270" x2="840" y1="196" y2="196"></line><polygon fill="#93c5fd" points="840.00,196.00 830.00,202.00 830.00,190.00" stroke="#93c5fd" stroke-width="2"></polygon>
<text fill="#e6e9ef" font-size="12" text-anchor="middle" x="555" y="186">startTest(name, desc)</text>
<line stroke="#93c5fd" stroke-width="2" x1="270" x2="470" y1="228" y2="228"></line><polygon fill="#93c5fd" points="470.00,228.00 460.00,234.00 460.00,222.00" stroke="#93c5fd" stroke-width="2"></polygon>
<text fill="#e6e9ef" font-size="12" text-anchor="middle" x="370" y="218">markTestStarted()</text>
<line stroke="#93c5fd" stroke-width="2" x1="90" x2="470" y1="266" y2="266"></line><polygon fill="#93c5fd" points="470.00,266.00 460.00,272.00 460.00,260.00" stroke="#93c5fd" stroke-width="2"></polygon>
<text fill="#e6e9ef" font-size="12" text-anchor="middle" x="280" y="256">startStep(title) / logDetail(...)</text>
<line stroke="#f87171" stroke-width="2" x1="470" x2="840" y1="298" y2="298"></line><polygon fill="#f87171" points="840.00,298.00 830.00,304.00 830.00,292.00" stroke="#f87171" stroke-width="2"></polygon>
<text fill="#fca5a5" font-size="12" text-anchor="middle" x="655" y="288">fail(msg, stacktraceText) (o singură dată)</text>
</svg>
<details>
<summary>Explicație <span class="sumhint">lifecycle test și reguli de eșec</span></summary>
<ul>
<li><b>Ce ilustrează:</b> Separarea responsabilităților dintre lifecycle-ul testului și semantica pașilor raportați.</li>
<li><b>Separarea responsabilităților:</b>
<ul>
<li><b>TestListener:</b> gestionează începutul și sfârșitul testului (evenimente TestNG) și creează/închide contextul de raportare la nivel de test.</li>
<li><b>StepLogger:</b> definește pasul semantic și controlează raportarea corectă, fiind singurul care poate emite FAIL într-un pas.</li>
</ul>
</li>
<li><b>Reguli implicite ale diagramei:</b>
<ul>
<li>Un singur FAIL per pas.</li>
<li>Detaliile se loghează doar în interiorul unui pas.</li>
<li>Excepțiile apărute în afara pașilor produc FAIL la nivel de test.</li>
<li><b>Interdicție:</b> <code class="inline">StepLogger.logDetail(...)</code> în afara unui step activ.</li>
</ul>
</li>
</ul>
</details>
<details>
<summary>Specificație diagramă (Mermaid)</summary>
<pre><code class="language-mermaid">sequenceDiagram
 autonumber
 participant Test as TestNG
 participant L as TestListener
 participant RM as ReportingManager
 participant SL as StepLogger
 participant RA as ReportLogger(Adapter)

 Test-&gt;&gt;L: onTestStart()
 L-&gt;&gt;RM: getLogger()
 RM-&gt;&gt;RA: resolve by reporting.engine
 L-&gt;&gt;RA: startTest(name, desc)
 L-&gt;&gt;SL: markTestStarted()

 Test-&gt;&gt;SL: startStep(title) / logDetail(...)
 SL-&gt;&gt;RA: startStep(title) / logDetail(...)

 SL-&gt;&gt;RA: fail(msg, stacktraceText) (single)</code></pre>
</details>
</div>
</details>
<details>
<summary>2.3 Lifecycle TestNG + reporting (UI) <span class="sumhint">sequence</span></summary>
<div class="diag">
<svg aria-label="UI lifecycle with screenshot" height="420" viewbox="0 0 980 420" width="980">
<defs>
<marker id="arrow3" markerheight="10" markerunits="strokeWidth" markerwidth="10" orient="auto" refx="9" refy="3">
<path d="M0,0 L10,3 L0,6 z" fill="#93c5fd"></path>
</marker>
</defs>
<text fill="#9ddcff" font-size="14" x="70" y="34">TestNG</text>
<text fill="#9ddcff" font-size="14" x="220" y="34">TestListener</text>
<text fill="#9ddcff" font-size="14" x="400" y="34">StepLogger</text>
<text fill="#9ddcff" font-size="14" x="580" y="34">ReportingManager</text>
<text fill="#9ddcff" font-size="14" x="770" y="34">ReportLogger</text>
<text fill="#9ddcff" font-size="14" x="910" y="34">Driver</text>
<line stroke="#334" x1="70" x2="70" y1="54" y2="390"></line>
<line stroke="#334" x1="220" x2="220" y1="54" y2="390"></line>
<line stroke="#334" x1="400" x2="400" y1="54" y2="390"></line>
<line stroke="#334" x1="580" x2="580" y1="54" y2="390"></line>
<line stroke="#334" x1="770" x2="770" y1="54" y2="390"></line>
<line stroke="#334" x1="910" x2="910" y1="54" y2="390"></line>
<line marker-end="url(#arrow3)" stroke="#93c5fd" stroke-width="2" x1="70" x2="220" y1="90" y2="90"></line>
<text fill="#e6e9ef" font-size="12" text-anchor="middle" x="145" y="80">onTestStart()</text>
<line marker-end="url(#arrow3)" stroke="#93c5fd" stroke-width="2" x1="220" x2="580" y1="120" y2="120"></line>
<text fill="#e6e9ef" font-size="12" text-anchor="middle" x="400" y="110">getLogger()</text>
<line marker-end="url(#arrow3)" stroke="#93c5fd" stroke-width="2" x1="220" x2="770" y1="150" y2="150"></line>
<text fill="#e6e9ef" font-size="12" text-anchor="middle" x="495" y="140">startTest(name, desc)</text>
<line marker-end="url(#arrow3)" stroke="#93c5fd" stroke-width="2" x1="220" x2="400" y1="180" y2="180"></line>
<text fill="#e6e9ef" font-size="12" text-anchor="middle" x="310" y="170">markTestStarted()</text>
<line marker-end="url(#arrow3)" stroke="#93c5fd" stroke-width="2" x1="70" x2="400" y1="220" y2="220"></line>
<text fill="#e6e9ef" font-size="12" text-anchor="middle" x="235" y="210">startStep / logDetail / pass</text>
<line marker-end="url(#arrow3)" stroke="#93c5fd" stroke-width="2" x1="70" x2="220" y1="270" y2="270"></line>
<text fill="#e6e9ef" font-size="12" text-anchor="middle" x="145" y="260">onTestFailure()</text>
<line marker-end="url(#arrow3)" stroke="#93c5fd" stroke-width="2" x1="220" x2="910" y1="300" y2="300"></line>
<text fill="#e6e9ef" font-size="12" text-anchor="middle" x="565" y="290">captureScreenshotAsBase64()</text>
<line marker-end="url(#arrow3)" stroke="#93c5fd" stroke-width="2" x1="220" x2="770" y1="332" y2="332"></line>
<text fill="#e6e9ef" font-size="12" text-anchor="middle" x="495" y="322">attachScreenshotBase64(base64, title) (TEST-level)</text>
<line marker-end="url(#arrow3)" stroke="#93c5fd" stroke-width="2" x1="220" x2="770" y1="362" y2="362"></line>
<text fill="#e6e9ef" font-size="12" text-anchor="middle" x="495" y="352">endTest(FAIL) + clearTestStarted()</text>
</svg>
<details>
<summary>Explicație <span class="sumhint">screenshot și eșec UI</span></summary>
<ul>
<li><b>Ce ilustrează:</b> separarea clară a responsabilităților dintre lifecycle-ul testului și pașii raportați.</li>
<li><b>Roluri:</b>
<ul>
<li><b>TestListener</b> controlează lifecycle-ul testului și gestionează screenshot-ul la FAIL.</li>
<li><b>StepLogger</b> creează pașii și este singurul care poate emite FAIL la nivel de pas.</li>
<li><b>ReportingManager</b> selectează adapterul de raportare.</li>
<li><b>Driver</b> (via DriverManager/UIEngine) furnizează screenshot Base64, fără a expune detalii de engine.</li>
</ul>
</li>
<li><b>Reguli cheie:</b>
<ul>
<li>Screenshot: un singur atașament per test FAIL, la nivel de test.</li>
<li>Stacktrace: doar în pasul care a eșuat.</li>
<li>StepLogger: un singur FAIL per pas; fără logging în afara pașilor.</li>
<li><b>Notă de integrare:</b> pentru Allure, ordinea listener-ilor este critică; atașamentele trebuie adăugate înainte de închiderea testului.</li>
</ul>
</li>
</ul>
</details>
<details>
<summary>Specificație diagramă (Mermaid)</summary>
<pre><code class="language-mermaid">sequenceDiagram
 autonumber
 participant Test as TestNG
 participant L as TestListener
 participant RM as ReportingManager
 participant SL as StepLogger
 participant RA as ReportLogger(Adapter)
 participant DM as DriverManager/Engine

 Test-&gt;&gt;L: onTestStart()
 L-&gt;&gt;RM: getLogger()
 L-&gt;&gt;RA: startTest(name, desc)
 L-&gt;&gt;SL: markTestStarted()

 Test-&gt;&gt;SL: startStep(...) / logDetail(...) / pass(...)
 SL-&gt;&gt;RA: startStep(...) / logDetail(...) / pass(...)

 Test-&gt;&gt;L: onTestFailure()
 L-&gt;&gt;DM: captureScreenshotAsBase64()
 L-&gt;&gt;RA: attachScreenshotBase64(base64, title) (TEST-level)
 L-&gt;&gt;RA: endTest(FAIL)
 L-&gt;&gt;SL: clearTestStarted()</code></pre>
</details>
</div>
</details>
<details>
<summary>2.4 Lifecycle TestNG + reporting (API) <span class="sumhint">sequence</span></summary>
<div class="diag">
<svg aria-label="API shared reporting lifecycle" height="400" viewbox="0 0 980 400" width="980">
<defs>
<marker id="arrow4" markerheight="10" markerunits="strokeWidth" markerwidth="10" orient="auto" refx="9" refy="3">
<path d="M0,0 L10,3 L0,6 z" fill="#93c5fd"></path>
</marker>
</defs>
<text fill="#9ddcff" font-size="14" x="70" y="34">TestNG</text>
<text fill="#9ddcff" font-size="14" x="220" y="34">Listener</text>
<text fill="#9ddcff" font-size="14" x="360" y="34">Service</text>
<text fill="#9ddcff" font-size="14" x="520" y="34">Validation</text>
<text fill="#9ddcff" font-size="14" x="700" y="34">StepLogger</text>
<text fill="#9ddcff" font-size="14" x="860" y="34">ReportLogger</text>
<line stroke="#334" x1="70" x2="70" y1="54" y2="370"></line>
<line stroke="#334" x1="220" x2="220" y1="54" y2="370"></line>
<line stroke="#334" x1="360" x2="360" y1="54" y2="370"></line>
<line stroke="#334" x1="520" x2="520" y1="54" y2="370"></line>
<line stroke="#334" x1="700" x2="700" y1="54" y2="370"></line>
<line stroke="#334" x1="860" x2="860" y1="54" y2="370"></line>
<line marker-end="url(#arrow4)" stroke="#93c5fd" stroke-width="2" x1="70" x2="220" y1="92" y2="92"></line>
<text fill="#e6e9ef" font-size="12" text-anchor="middle" x="145" y="82">onTestStart()</text>
<line marker-end="url(#arrow4)" stroke="#93c5fd" stroke-width="2" x1="220" x2="860" y1="124" y2="124"></line>
<text fill="#e6e9ef" font-size="12" text-anchor="middle" x="540" y="114">startTest(...)</text>
<line marker-end="url(#arrow4)" stroke="#93c5fd" stroke-width="2" x1="220" x2="700" y1="156" y2="156"></line>
<text fill="#e6e9ef" font-size="12" text-anchor="middle" x="460" y="146">markTestStarted()</text>
<line marker-end="url(#arrow4)" stroke="#93c5fd" stroke-width="2" x1="70" x2="360" y1="200" y2="200"></line>
<text fill="#e6e9ef" font-size="12" text-anchor="middle" x="215" y="190">call flow</text>
<line marker-end="url(#arrow4)" stroke="#93c5fd" stroke-width="2" x1="360" x2="700" y1="232" y2="232"></line>
<text fill="#e6e9ef" font-size="12" text-anchor="middle" x="530" y="222">startStep("HTTP ...") + logDetail(...)</text>
<line marker-end="url(#arrow4)" stroke="#93c5fd" stroke-width="2" x1="360" x2="860" y1="264" y2="264"></line>
<text fill="#e6e9ef" font-size="12" text-anchor="middle" x="610" y="254">logCodeBlock(payload) (via ReportingManager.getLogger())</text>
<line marker-end="url(#arrow4)" stroke="#93c5fd" stroke-width="2" x1="70" x2="520" y1="304" y2="304"></line>
<text fill="#e6e9ef" font-size="12" text-anchor="middle" x="295" y="294">assertions</text>
<line marker-end="url(#arrow4)" stroke="#93c5fd" stroke-width="2" x1="520" x2="700" y1="336" y2="336"></line>
<text fill="#e6e9ef" font-size="12" text-anchor="middle" x="610" y="326">startStep("Validate ...") + pass/fail (single)</text>
</svg>
<details>
<summary>Explicație <span class="sumhint">API cu reporting partajat</span></summary>
<ul>
<li><b>Ce ilustrează:</b> execuția unui test API cu mecanism de reporting reutilizat.</li>
<li><b>Pași în testele API:</b>
<ul>
<li><b>Service</b> execută request-uri HTTP și creează pași HTTP …, cu metoda, path-ul, URL-ul și parametrii relevanți.</li>
<li><b>Payload-uri</b> (request/response) sunt atașate ca code block în raport.</li>
<li><b>Validations</b> rulează aserțiuni în pași separați, pentru a diferenția clar eșecul de request de cel de validare.</li>
</ul>
</li>
</ul>
<div class="rule">
<b>Recomandare de naming pentru pași API:</b>
<ul>
<li><b>HTTP step:</b> <code class="inline">HTTP {METHOD} {relativePath}</code> (și în details: URL complet).</li>
<li><b>Validation step:</b> <code class="inline">Validate: {expectations}</code> (ex. status=201, schema ok).</li>
</ul>
</div>
</details>
<details>
<summary>Specificație diagramă (Mermaid)</summary>
<pre><code class="language-mermaid">sequenceDiagram
 autonumber
 participant Test as TestNG
 participant L as TestListener(API or shared)
 participant SL as StepLogger(shared)
 participant RM as ReportingManager(shared)
 participant RA as ReportLogger(Adapter)
 participant SVC as Service Objects
 participant VAL as Validation

 Test-&gt;&gt;L: onTestStart()
 L-&gt;&gt;RM: getLogger()
 RM--&gt;&gt;L: ReportLogger
 L-&gt;&gt;RA: startTest(...)
 L-&gt;&gt;SL: markTestStarted()

 Test-&gt;&gt;SVC: call flow
 SVC-&gt;&gt;SL: startStep("HTTP ...")
 SVC-&gt;&gt;SL: logDetail("request.body") / ...
 SVC-&gt;&gt;RM: getLogger().logCodeBlock(payload) Note right of SVC: dacă StepLogger nu expune logCodeBlock
 SVC-&gt;&gt;SL: pass("Call completed")

 Test-&gt;&gt;VAL: assertions
 VAL-&gt;&gt;SL: startStep("Validate ...")
 VAL-&gt;&gt;SL: pass/ fail (single)</code></pre>
</details>
</div>
</details>
<details>
<summary>2.5 Structura nodurilor în raport <span class="sumhint">UX model</span></summary>
<div class="diag">
<svg aria-label="Report node structure" height="300" viewbox="0 0 980 300" width="980">
<defs>
<marker id="arrow5" markerheight="10" markerunits="strokeWidth" markerwidth="10" orient="auto" refx="9" refy="3">
<path d="M0,0 L10,3 L0,6 z" fill="#93c5fd"></path>
</marker>
</defs>
<rect fill="#1e293b" height="46" rx="10" width="200" x="40" y="40"></rect><text fill="#e6e9ef" font-size="13" text-anchor="middle" x="140" y="69">Test Node</text>
<rect fill="#1e293b" height="46" rx="10" width="200" x="290" y="40"></rect><text fill="#e6e9ef" font-size="13" text-anchor="middle" x="390" y="69">Metadata</text>
<rect fill="#1e293b" height="46" rx="10" width="200" x="540" y="40"></rect><text fill="#e6e9ef" font-size="13" text-anchor="middle" x="640" y="69">Screenshot (FAIL)</text>
<rect fill="#1e293b" height="46" rx="10" width="200" x="40" y="130"></rect><text fill="#e6e9ef" font-size="13" text-anchor="middle" x="140" y="159">Step Node (collapsible)</text>
<rect fill="#1e293b" height="46" rx="10" width="200" x="290" y="130"></rect><text fill="#e6e9ef" font-size="13" text-anchor="middle" x="390" y="159">Details</text>
<rect fill="#1e293b" height="46" rx="10" width="200" x="540" y="130"></rect><text fill="#e6e9ef" font-size="13" text-anchor="middle" x="640" y="159">Payloads (code)</text>
<rect fill="#1e293b" height="46" rx="10" width="200" x="290" y="220"></rect><text fill="#e6e9ef" font-size="13" text-anchor="middle" x="390" y="249">PASS / FAIL</text>
<rect fill="#1e293b" height="46" rx="10" width="200" x="540" y="220"></rect><text fill="#e6e9ef" font-size="13" text-anchor="middle" x="640" y="249">Stacktrace (step only)</text>
<line marker-end="url(#arrow5)" stroke="#93c5fd" stroke-width="2" x1="240" x2="290" y1="63" y2="63"></line>
<line marker-end="url(#arrow5)" stroke="#93c5fd" stroke-width="2" x1="490" x2="540" y1="63" y2="63"></line>
<line marker-end="url(#arrow5)" stroke="#93c5fd" stroke-width="2" x1="140" x2="140" y1="86" y2="130"></line>
<line marker-end="url(#arrow5)" stroke="#93c5fd" stroke-width="2" x1="240" x2="290" y1="153" y2="153"></line>
<line marker-end="url(#arrow5)" stroke="#93c5fd" stroke-width="2" x1="490" x2="540" y1="153" y2="153"></line>
<line marker-end="url(#arrow5)" stroke="#93c5fd" stroke-width="2" x1="390" x2="390" y1="176" y2="220"></line>
<line marker-end="url(#arrow5)" stroke="#93c5fd" stroke-width="2" x1="490" x2="540" y1="243" y2="243"></line>
</svg>
<details>
<summary>Explicație <span class="sumhint">model UX al raportului</span></summary>
<ul>
<li><b>Ce ilustrează:</b> definește “contractul UX” al raportului: unde se pune fiecare categorie de informație, ca raportul să fie <i>scanabil</i> și fără duplicări.</li>
<li><b>Test Node:</b>
<ul>
<li><b>Conține:</b> nume test, descriere, timp de execuție, status final (PASS/FAIL/SKIP) etc.</li>
<li><b>NU conține:</b> stacktrace, payload-uri, detalii de pas. </li>
</ul>
</li>
<li><b>Step Node:</b>
<ul>
<li><b>Titlu semantic:</b> arată acțiunea/intenția (ex. “Click on: Register”, “HTTP POST /users”, “Validate: status 201”).</li>
<li><b>Details:</b> scurte și standardizate, suficiente pentru a înțelege ce s-a executat.</li>
<li><b>Payloads/stacktrace:</b> doar ca <b>code blocks</b> pentru lizibilitate.</li>
<li><b>Rezultat:</b> PASS/FAIL la nivel de step.</li>
</ul>
</li>
<div class="rule">
<b>Set minim de detalii recomandate (standardizare):</b>
<div class="split">
<div class="mini">
<h3>UI step — details</h3>
<ul>
<li><code class="inline">locator=cssSelector</code></li>
<li><code class="inline">value=...</code> (pentru type/select)</li>
<li><code class="inline">wait=visible/clickable</code> (dacă s-a aplicat explicit)</li>
</ul>
</div>
<div class="mini">
<h3>API step — details</h3>
<ul>
<li><code class="inline">method=POST</code>, <code class="inline">path=/public/v2/users</code></li>
<li><code class="inline">url=https://.../public/v2/users</code></li>
<li><code class="inline">status=201</code> (după primirea răspunsului)</li>
</ul>
</div>
</div>
</div>
</details>
<details>
<summary>Specificație diagramă (Mermaid)</summary>
<pre><code class="language-mermaid">flowchart TD
 T["Test Node (PASS/FAIL/SKIP)"]
 META["Metadata (name, desc, env)"]
 SS["Screenshot (FAIL only, test-level)"]
 S1["Step 1 (collapsible)"]
 D1["Details (lines)"]
 P1["Payload (code blocks)"]
 R1["Result PASS/FAIL"]
 ST1["Stacktrace (single code block, only in failing step)"]

 T --&gt; META
 T --&gt; SS
 T --&gt; S1
 S1 --&gt; D1
 S1 --&gt; P1
 S1 --&gt; R1
 R1 --&gt; ST1</code></pre>
</details>
</div>
<div class="rule">
<b>Regulă de aur:</b> stacktrace-ul apare o singură dată, numai în step-ul care a picat. Test node-ul nu primește stacktrace.
   </div>
</details>
</div>
<hr class="sep"/>
<div class="card">
<h2>3) Reguli canonice (UI + API) — MUST / MUST NOT</h2>
<details>
<summary>3.1 Configurație <span class="sumhint">fără hardcoding</span></summary>
<ul>
<li><b>MUST</b> toate setările în <code class="inline">framework.properties</code> (classpath).</li>
<li><b>MUST</b> acces doar via <code class="inline">ConfigManager</code>.</li>
<li><b>MUST</b> crează <code class="inline">reports.dir</code> înainte de primul raport.</li>
<li><b>MUST</b> dacă <code class="inline">reporting.engine=allure</code>, create <code class="inline">allure.results.dir</code> înainte de execuție.</li>
</ul>
</details>
<details>
<summary>3.2 Logging &amp; Step semantics <span class="sumhint">StepLogger</span></summary>
<ul>
<li><b>MUST</b> fiecare pas semantic să fie creat exclusiv prin <code class="inline">StepLogger.startStep(...)</code>.</li>
<li><b>MUST</b> <code class="inline">StepLogger</code> să fie singurul care poate apela <code class="inline">ReportLogger.fail(...)</code>.</li>
<li><b>MUST</b> exact un FAIL per step (fără duplicări).</li>
<li><b>MUST</b> <code class="inline">StepLogger.logDetail(...)</code> să fie apelat doar în interiorul unui pas activ.</li>
<li><b>MUST</b> stacktrace-ul să fie redat o singură dată și numai ca monospace code block.</li>
<li><b>MUST</b> orice excepție apărută în afara unui pas activ să producă FAIL la nivel de test.</li>

<li><b>MUST</b> screenshot-ul să fie capturat doar din <code class="inline">TestListener</code> o singură dată per test FAIL, atașat la nivel de test și doar dacă există un UIEngine activ.</li>
<li><b>MUST NOT</b> loga detalii sau FAIL în afara pașilor.</li>
</ul>
<details>
<summary>Logging în consolă <span class="sumhint">format + toggle</span></summary>
<ul>
<li><b>MUST</b> console logging exclusiv prin StepLogger.</li>
<li><b>MUST</b> afișează start step + PASS/FAIL.</li>
<li><b>MAY</b> afișează și detalii dacă <code class="inline">console.details.enabled=true</code> (când e implementat).</li>
</ul>
<pre><code>▶ Type into element: Email
 • locator=input[data-test='email']
 • value=test@example.com
 ✅ PASS: Typed</code></pre>
</details>
</details>
<details>
<summary>3.3 UI: interacțiuni + waits <span class="sumhint">UIActions + WaitUtils</span></summary>
<ul>
<li><b>MUST</b> UI interactions doar prin <code class="inline">UIActions</code>.</li>
<li><b>MUST</b> waits doar prin <code class="inline">WaitUtils</code>.</li>
<li><b>MUST</b> decizia de a aștepta este în <code class="inline">UIActions</code> (engine-aware).</li>
<li><b>MUST</b> Playwright: <code class="inline">supportsAutoWait()=true</code>; Selenium: <code class="inline">false</code>.</li>
<li><b>MUST NOT</b> WaitUtils să emită FAIL direct (doar intent; FAIL vine din step).</li>
</ul>
<h4>UIEngine definește contractul minim pentru execuția acțiunilor UI</h4>
<ul>
<li><b>MUST</b> expune doar operații de bază (click, type, getText, wait), fără logică de test sau reporting.</li>
</ul>
<h4>Strategie engine-aware pentru waits (MUST)</h4>
<ul>
<li><code>UIEngine</code> MUST expune <code>boolean supportsAutoWait()</code>.</li>
<li>Engine-urile bazate pe Selenium MUST returna <code>false</code>.</li>
<li>Engine-urile bazate pe Playwright MUST returna <code>true</code>.</li>
<li><code>UIActions</code> MUST decide dacă e necesar un explicit wait înainte de interacțiuni.</li>
</ul>
<pre><code class="language-java">private static void waitIfRequired(String cssSelector) {
  if (!DriverManager.getEngine().supportsAutoWait()) {
    WaitUtils.waitForVisible(cssSelector);
  }
}</code></pre>
</details>
<details>
<summary>3.4 API: service objects + validations <span class="sumhint">no direct endpoints in tests</span></summary>
<ul>
<li><b>MUST</b> testele nu referă endpoint-uri/metode direct.</li>
<li><b>MUST</b> toate apelurile prin Service Objects.</li>
<li><b>MUST</b> assertions doar în validation layer, în pași logați.</li>
<li><b>MUST</b> request models via factory/builder (fără setări directe în test).</li>
</ul>
<h4>Contract ApiClient:</h4>
<ul>
<li><b>MUST</b> este responsabil exclusiv de execuția apelurilor HTTP.</li>
<li><b>MUST NOT</b> conține validări, aserțiuni sau logică de reporting.</li>
</ul>
</details>
<details>
<summary>3.5 Reporting: engines + adapters <span class="sumhint">extent / allure</span></summary>
<ul>
<li><b>MUST</b> <code class="inline">reporting.engine</code> resolve exclusiv în <code class="inline">ReportingManager</code>.</li>
<li><b>MUST</b> adapters implementează <code class="inline">ReportLogger</code>.</li>
<li><b>MUST</b> fără obiecte Throwable în adapter; doar text (stacktraceAsText).</li>
<li><b>MUST</b> payload-urile ca code blocks (în Extent: MarkupHelper.createCodeBlock).</li>
<li><b>MUST</b> screenshot doar din TestListener (exact o dată per test FAIL), atașat la nivel de test.</li>
</ul>
</details>
<details>
<summary>3.6 CSS &amp; aspect (Extent) (MUST) <span class="sumhint">MUST</span></summary>
<pre><code>.card-title a span { color: #f2f2f2 !important; }
.card-title a { color: #f2f2f2 !important; }
.fa { color: #f2f2f2 !important; }</code></pre>
</details>
<details>
<summary>3.7 Dependențe Maven <span class="sumhint">pom.xml scope</span></summary>
<div class="rule">
<ul>
<li>
  <b>MUST NOT</b> declara in <code class="inline">pom.xml</code>
        cu <code class="inline">&lt;scope&gt;test&lt;/scope&gt;</code> dependențe de framework care sunt utilizate la runtime.
      </li>
<li>
         <b>MUST</b> toate dependențele framework-ului să fie disponibile la runtime.
      </li>
</ul>
</div>
</details>
<details>
<summary>3.8 Contract canonic de raportare (UI + API) <span class="sumhint">ReportLogger &amp; StepLogger</span></summary>
<ul>
<li><b>ReportLogger</b> MUST expune EXACT următoarele metode:</li>
</ul>
<pre><code>void startTest(String testName, String description);
void endTest(String status);            // PASS | FAIL | SKIP
void startStep(String stepTitle);
void logDetail(String detail);
void pass(String message);
void fail(String message, String stacktraceAsText);
void attachScreenshotBase64(String base64, String title);
void logCodeBlock(String content);
void flush();</code></pre>
</details>
</div>
<hr class="sep"/>
<div class="card">
<h2>4) Organizarea testelor</h2>
<div class="split">
<div class="mini">
<details>
<summary><span class="label">UI</span> — cerințe de test (MUST)</summary>
<div class="details-body">
<ul>
<li><b>Target UI (config):</b> <code>{base.url}</code> = <code>https://practicesoftwaretesting.com</code></li>
<li><b>Pagină de înregistrare (MUST):</b> <code>{base.url}/auth/register</code> (ex.: <code>https://practicesoftwaretesting.com/auth/register</code>)</li>
</ul>
<ul>
<li><b>MUST</b> minim: 1 test pozitiv + 3 negative</li>
<li><b>MUST</b> navigare obligatorie: <code>{base.url}/auth/register</code></li>
<li><b>MUST</b> layering: <code>Tests → Services → Pages/Validation</code></li>
<li><b>MUST NOT</b> acces direct la UI engine</li>
<li><b>Positive:</b> validare înregistrare cu mesaj de confirmare</li>
<li><b>Negative:</b> email invalid/duplicat, lipsă câmpuri obligatorii, password mismatch (dacă există)</li>
</ul>
</div>
<details>
<summary>Detalii suplimentare<span class="sumhint">locators &amp; test data</span></summary>
<h4>Locatori</h4>
<ul>
<li><b>CSS selectors</b> MUST be used.</li>
<li><b>XPath</b> ONLY when CSS cannot express text matching.</li>
</ul>
<pre><code>button[data-test='submit']
xpath: //button[text()='Register']</code></pre>
<div class="note">
<b>Demo / POC Guidance:</b>
Locatorii POT fi defensivi (id, name, data-test alternativ).
Această regulă este ilustrativă și MUST fi adaptată pentru aplicații reale.
</div>
<h4>Date de test</h4>
<ul>
<li>Toate datele de test MUST fie JSON sub <code class="inline">src/test/resources/testdata</code>.</li>
<li>Datele unice MUST fi generate prin <code class="inline">DataGenerator</code>.</li>
</ul>
</details></details>
</div>
<div class="mini">
<details>
<summary><span class="label">API</span> — cerințe de test (MUST)</summary>
<div class="details-body">
<ul>
<li><b>Target API (config):</b> <code>{base.url.api}</code> = <code>https://gorest.co.in</code></li>
</ul>
<ul>
<li><b>MUST</b> teste complet independente (ordine irelevantă)</li>
<li><b>MUST</b> cleanup pentru datele create</li>
<li><b>MUST</b> GET/UPDATE/DELETE: fiecare test își creează entitatea în setup</li>
<li><b>MUST</b> ierarhie: Positive / Negative / End-to-end</li>
<li><b>MUST</b> E2E: Create → Get → Update → Delete → Verify deletion</li>
<li><b>MUST</b> JSON Schema validation în pași logați (schemas version-controlled)</li>
</ul>
</div>
<details>
<summary>API under test (gorest) <span class="pill">base + endpoints</span></summary>
<div class="details-body">
<pre><code>Base URL (config): {base.url.api} = https://gorest.co.in

POST  /public/v2/users      -&gt; expect 201
GET  /public/v2/users/{user_id} -&gt; expect 200
PUT  /public/v2/users/{user_id} -&gt; expect 200/201
PATCH /public/v2/users/{user_id} -&gt; expect 200/201
DELETE /public/v2/users/{user_id} -&gt; expect 204</code></pre>
</div>
</details><details><summary>Autentificare &amp; Autorizare (API) <span class="sumhint">auth.token</span></summary>
<ul>
<li><b>MUST</b> token-ul de autentificare să fie definit în config:
    <code class="inline">auth.token</code>.</li>
<li><b>MUST</b> autentificarea să fie gestionată centralizat (ex: <code class="inline">ApiClient</code>).</li>
<li><b>MUST NOT</b> testele să construiască manual headere de autentificare.</li>
<li><b>MUST NOT</b> token-ul să fie hardcodat în teste.</li>
<li>Pentru operații <b>WRITE</b> (POST / PUT / PATCH / DELETE):
  <ul>
<li><b>MUST</b> token prezent.</li>
<li>Lipsa token-ului → <b>SKIP</b> sau <b>FAIL</b> controlat, explicit.</li>
</ul>
</li>
</ul>
</details></details>
</div>
</div>
<details>
<summary>Listeners + BaseTests + testng.xml</summary>
<div class="details-body">
<div class="split"><div class="mini">
<div class="muted"><b>BaseTestUI</b> (toate testele UI extind această clasă)</div>
<pre><code>@Listeners({
    AllureTestNg.class,
    TestListener.class
})
public abstract class BaseTestUI {

  @BeforeMethod(alwaysRun = true)
  public void setUp() {
    ConfigManager.load();
    DriverManager.initEngine();
  }

  @AfterMethod(alwaysRun = true)
  public void tearDown() {
    DriverManager.quitEngine();
  }
}</code></pre>
</div><div class="mini">
<div class="muted"><b>BaseTestAPI</b> (toate testele API extind această clasă)</div>
<pre><code>@Listeners({
    AllureTestNg.class,
    TestListener.class
})
public abstract class BaseTestAPI {

  @BeforeClass(alwaysRun = true)
  public void baseSetup() {
    ApiClient.init();
    requireTokenForWrites();
  }

  protected void requireTokenForWrites() {
    String token = ConfigManager.get("auth.token");
    if (token == null || token.isBlank()) {
      throw new SkipException("auth.token is not set; GoRest write operations require a token");
    }
  }
}</code></pre>
</div>
</div>
<div class="muted" style="margin-top:12px;"><b>testng.xml</b> (structurare / listeners la nivel suită)</div>
<pre><code>&lt;suite name="Framework Suite" parallel="false"&gt;
 &lt;listeners&gt;
  &lt;listener class-name="io.qameta.allure.testng.AllureTestNg"/&gt;
  &lt;listener class-name="com.endava.ai.ui.core.TestListener"/&gt;
 &lt;/listeners&gt;

 &lt;test name="UI Tests"&gt;
  &lt;packages&gt;
   &lt;package name="com.endava.ai.ui.tests"/&gt;
  &lt;/packages&gt;
 &lt;/test&gt;

 &lt;test name="API Tests"&gt;
  &lt;packages&gt;
   &lt;package name="com.endava.ai.api.tests"/&gt;
  &lt;/packages&gt;
 &lt;/test&gt;
&lt;/suite&gt;</code></pre>
</div>
<div class="warn">
<b>Regulă:</b> <code class="inline">AllureTestNg</code> se înregistrează înaintea <code class="inline">TestListener</code> pentru ca raportarea să fie inițializată corect înainte de atașamente și închiderea testului.
</div>
</details>
</div>
<hr class="sep"/>
<div class="card">
<h2>5) Artefacte livrare</h2>
<div class="split">
<div class="mini">
<h3>UI</h3>
<ul>
<li>Complete Maven project</li>
<li><code class="inline">pom.xml</code>, <code class="inline">framework.properties</code>, <code class="inline">testng.xml</code>, <code class="inline">README.md</code></li>
<li>README: setup, exec, approach, reporting, Allure usage</li>
</ul>
</div>
<div class="mini">
<h3>API</h3>
<ul>
<li>Complete Maven project</li>
<li><code class="inline">pom.xml</code>, <code class="inline">framework.properties</code>, <code class="inline">testng.xml</code>, <code class="inline">README.md</code></li>
<li>README: setup, exec, approach, reporting, shared/local mode</li>
</ul>
</div>
</div>
</div>
</details>
</div>
</div></body>
</html>
